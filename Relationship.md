# Relationship

Describing how entities of the database can form relationships,
and the network effects that derive therefrom.

## A database entity represents a person

In this fully sharded database,
the entities represent people,
each one of whom we call a "participant".

Each participant is represented
by a pico,
which we consider the corresponding person to "own".

### Implementation

Each participant pico has these rulesets installed:
1. `io.picolabs.pds` (persisting entity data)
2. `html.byu` (facilitating web page generation)
3. `byu.hr.core` (making the pico an entity)
4. `byu.hr.record` (allowing recording of audio)

(listed in an order in which they can be installed).

## Entity landing page

The `index` function shared by the core ruleset
produces a web page called the "landing page"
for the corresponding participant.

A person logged into the website will see their own information
in a such a web page we call the "logged-in landing page".

### Implementation

Given an ECI for a particular participant pico,
as a logged-in participant yourself,
you can visit that person's landing page with a URL like
```
https://DOMAIN:PORT/c/ECI/query/byu.hr.core/index.html
```
(assuming that ECI's policy allows this query).

### Pluggable applications

Besides the main functionality of landing page
(implemented by the first three rulesets listed above)
each participant can record their own voice
pronouncing their own name.

That ability is implemented by the fourth ruleset,
which we consider a built-in application.

Other applications can be plugged-in to the core functionality.
This is enabled by an additional ruleset installed
in a participant pico.

### Implementation

The `byu.hr.manage_apps` ruleset stores the list of apps
installed in a participant pico,
and provides a UX for seeing them and
adding additional pluggable apps.

## Network effects

The `byu.hr.relate` ruleset will be the next app installed
in a participant pico that can manage apps,
and allows for the management of relationships.

A participant who can manage apps and relationships will see a widget
like this on the landing page of other participants:

<img width="405" alt="Screen_Shot_2022-10-19_at_23_06_24" src="https://user-images.githubusercontent.com/19273926/196861290-6c1a9196-bf25-4edc-9bdb-c18af0bcae4b.png">

### Implementation

The form is generated by [these lines](https://github.com/Picolab/fully-sharded-database/blob/edbcd9b08cf2cd433ab43e7f06a9118d8befd6af/krl/byu.hr.core.krl#L329-L338)
of the core ruleset.

### Bootstrap

The other participant pico will not, in general have the manage apps and relate rulesets installed in their pico.

To this end, when they next visit their landing page,
they will see a widget like this:

<img width="737" alt="Screen_Shot_2022-10-20_at_00_03_59" src="https://user-images.githubusercontent.com/19273926/196869213-968e378a-623d-4ccf-87f6-2d6dbba830a8.png">

If/when the other participant chooses to accept the implicit offer
(of installing the manage apps and relate rulesets)
by clicking on the button,
those rulesets will be installed and the widget will change to look like this:

<img width="738" alt="Screen Shot 2022-10-20 at 00 09 31" src="https://user-images.githubusercontent.com/19273926/196869969-f4fab13a-c1b7-4dae-8b4f-c7e7b3535a96.png">

At this point, this person is now a "participant who can manage apps and relationships"
and so they will also see the widget allowing them to propose relationships
to other participants.

## Establishing a relationship

The only way that a relationship can be established
is for one participant to propose it to another,
and for the other participant to click on the 
"Manage your relationships" button and accept the proposed relationship.

Once this has been done, the accepting participant
will only see the "Manage your apps" button on their landing page.

### Bootstrap implementation

The above discussion describes the "going viral" part of the bootstrap.

To get things started, a pico engine administrator manually installed
the manage apps and relate rulesets in their own participant pico.

This person then logged in and began proposing relationships
with other participants.

